import{c as T,S as E,i as R,_ as f,n as j,a as L}from"./index-75c887b9.js";const g=[{label:"文字",value:"text",props:[{label:"行数",name:"rows",value:{type:"number",required:!1,min:1,max:10,default:1}},{label:"最大长度",name:"maxLength",value:{type:"number",required:!1,min:0,max:1e3}},{label:"必填",name:"required",value:{type:"switch"}}]},{label:"数字",value:"number",props:[{label:"最小值",name:"min",value:{type:"number",required:!1,precision:2}},{label:"最大值",name:"max",value:{type:"number",required:!1,precision:2}},{label:"步长",name:"step",value:{type:"number",required:!1,precision:2}},{label:"精度",name:"precision",value:{type:"number",required:!1,min:0}},{label:"单位",name:"unit",value:{type:"text",required:!1,placeholder:"如：个，没有单位不用填写"}},{label:"必填",name:"required",value:{type:"switch"}}]},{label:"图片",value:"image",props:[{label:"文件大小",name:"maxSize",value:{type:"number",required:!1,min:.1,step:.1,ratio:1024*1024,unit:"M"}},{label:"建议尺寸",name:"tip",value:{type:"text",required:!1,placeholder:"如：300x400"}},{label:"必填",name:"required",value:{type:"switch"}}]},{label:"文件",value:"file",props:[{label:"文件大小",name:"maxSize",value:{type:"number",required:!1,min:.1,step:.1,ratio:1024*1024,unit:"M"}},{label:"最大文件数",name:"count",value:{type:"number",required:!1,min:1}},{label:"文件格式",name:"accept",value:{type:"select",required:!1,options:[".docx",".xlsx",".pdf",".txt",".zip"],valueKey:"$"}},{label:"必填",name:"required",value:{type:"switch"}}]},{label:"单选框",value:"radio",constProps:{valueKey:"$"},props:[{label:"选项",name:"options",value:{type:"tags"}},{label:"必填",name:"required",value:{type:"switch"}}]},{label:"多选框",value:"checkbox",constProps:{valueKey:"$"},props:[{label:"选项",name:"options",value:{type:"tags"}},{label:"必填",name:"required",value:{type:"switch"}}]},{label:"选择框",value:"select",constProps:{valueKey:"$"},props:[{label:"选项",name:"options",value:{type:"tags"}},{label:"必填",name:"required",value:{type:"switch"}}]},{label:"日期",value:"date",props:[{label:"必填",name:"required",value:{type:"switch"}}]}],s=window.Vue.resolveComponent,a=window.Vue.createVNode,t=window.Vue.createElementVNode,n=window.Vue.unref,C=window.Vue.renderList,k=window.Vue.Fragment,i=window.Vue.openBlock,w=window.Vue.createElementBlock,M=window.Vue.toDisplayString,h=window.Vue.createBlock,c=window.Vue.withCtx,U=window.Vue.createCommentVNode,W=window.Vue.isRef,A=window.Vue.createTextVNode,G=window.Vue.createStaticVNode,H={class:"_w_920 _pl_20"},J=t("div",{class:"_h_10"},null,-1),Q=t("div",{class:"_h_10"},null,-1),X=t("div",{class:"_h_10"},null,-1),Y={class:"_w_920 _bo _bob_0 _m_20"},Z=G('<div class="_wf_60 _fx_r"><div class="_w_40 _fx_rc_as _pt_10">顺序</div><div class="_w_200 _fx_rc_as _pt_10">字段标签</div><div class="_w_200 _fx_rc_as _pt_10">字段名称</div><div class="_w_200 _fx_rc_as _pt_10">字段类型</div><div class="_w_200 _fx_rc_as _pt_10">字段属性</div><div class="_w_80 _fx_rc_as _pt_10">操作</div></div>',1),ee={class:"_full_white _fx_r _bob"},le={class:"_hf_40 _fx_rc _is_drag"},oe={class:"_w_200 _pl_20"},te={class:"_w_200 _pl_20"},ae={class:"_w_200 _pl_20"},re={class:"_w_200"},se={class:"_w_120 _ml_20 _button"},ne={class:"_hf_80 _fx_rc"},ie={class:"_wf_60 _fx_r_je _ph_20"},_e={__name:"CreateForm",props:{forms:null,formOptions:{default:{api:"test",formatParams:"({$})=>$",formatResult:"({$, utils})=>utils.$alert($)"}},callback:null},setup(_){var y;const m=_;let F=(y=m.forms)!=null&&y.length?m.forms:[{form:{label:"姓名",name:"name",type:"text"},props:{}}];const r=T(F.map((e,o)=>({i:o,x:0,y:o,w:1,h:1,form:e.form,props:e.props}))),v=e=>f.find(g,o=>o.value===e.form.type),$=e=>{e.props={},e.hideFormVisbile=!0,j(()=>{e.hideFormVisbile=!1})},I=(e,o)=>{e=f.cloneDeep(e),e.i=f.maxValue(r,"i")+1,r.splice(o+1,0,e)},N=e=>{r.length>1&&r.splice(e,1)},S=()=>{const e=f.orderBy(r,o=>o.y).map(o=>{const p=v(o).constProps||{};return{form:o.form,props:{...o.props,...p}}});m.callback(e,m.formOptions),L.dialog2.close()};return(e,o)=>{const x=s("FormNumberItem"),p=s("FormTextItem"),V=s("FormCodeItem"),B=s("Icon"),P=s("FormSelectItem"),z=s("FormItem"),D=s("el-form"),K=s("el-popover"),b=s("el-button");return i(),w("div",null,[t("div",H,[a(x,{label:"标签宽度",prop:"labelWidth",form:_.formOptions,min:40,max:200,required:!1},null,8,["form"]),J,a(p,{label:"表单接口",prop:"api",type:"text",form:_.formOptions,placeholder:"填写数据接口,如:create/member",required:!1},null,8,["form"]),Q,a(V,{label:"修正参数",prop:"formatParams",form:_.formOptions,placeholder:"填写js函数: ({ $, _, moment })=>xx",required:!1},null,8,["form"]),X,a(V,{label:"结果处理",prop:"formatResult",form:_.formOptions,placeholder:"填写js函数: ({ $, _, moment })=>xx",required:!1},null,8,["form"])]),t("div",Y,[Z,a(n(E),{layout:n(r),"onUpdate:layout":o[0]||(o[0]=l=>W(r)?r.value=l:null),"row-height":50,"col-num":1,margin:[0,0]},{default:c(()=>[(i(!0),w(k,null,C(n(r),(l,q)=>(i(),h(n(R),{key:l.i,x:l.x,y:l.y,w:l.w,h:l.h,i:l.i,"is-resizable":!1,"drag-allow-from":"._is_drag"},{default:c(()=>[t("div",ee,[t("div",le,[a(B,{icon:"icon-move",color:"#a0a0a0"})]),t("div",oe,[a(p,{prop:"label",type:"text",form:l.form,placeholder:"填写字段标签",required:!1},null,8,["form"])]),t("div",te,[a(p,{prop:"name",type:"text",form:l.form,placeholder:"填写字段名称",required:!1},null,8,["form"])]),t("div",ae,[a(P,{prop:"type",form:l.form,options:n(g),labelKey:"label",valueKey:"value",placeholder:"选择字段类型",required:!1,onChange:u=>$(l)},null,8,["form","options","onChange"])]),t("div",re,[l.form.type&&!l.hideFormVisbile?(i(),h(K,{key:0,width:500},{reference:c(()=>[t("div",se," 共有"+M(v(l).props.length||0)+"项字段属性 ",1)]),default:c(()=>[a(D,{model:l.props,"label-width":100},{default:c(()=>{var u;return[(i(!0),w(k,null,C((u=v(l))==null?void 0:u.props,(d,O)=>(i(),h(z,{key:O,label:d.label,prop:d.name,value:d.value,field:d,form:l.props},null,8,["label","prop","value","field","form"]))),128))]}),_:2},1032,["model"])]),_:2},1024)):U("",!0)]),t("div",ne,[a(b,{type:"primary",icon:e.icon.CopyDocument,circle:"",size:"small",onClick:u=>I(l,q)},null,8,["icon","onClick"]),a(b,{disabled:n(r).length<=1,type:"danger",icon:e.icon.Delete,circle:"",size:"small",onClick:u=>N(q)},null,8,["disabled","icon","onClick"])])])]),_:2},1032,["x","y","w","h","i"]))),128))]),_:1},8,["layout"])]),t("div",ie,[a(b,{type:"primary",plain:"",onClick:S},{default:c(()=>[A("确定")]),_:1})])])}}};export{_e as default};
